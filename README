# Faucet Lobby

A game server lobby system originally created for Gang Garrison 2 but designed to be more generic. This is a Python-based server discovery system that allows game servers to register themselves and clients to query for available servers.

## Running the Server

Start the lobby server:
```bash
python lobby.py
```

The server requires Python 3. Install dependencies using `requirements.txt`:
```bash
pip install -r requirements.txt
```
You can also install the package in editable mode:
```bash
pip install -e .
```

### Configuration

Runtime constants such as network ports, banned IPs and lobby names are
defined in `config.py`. Adjust these values as needed. The default ports
match the existing behaviour:

```
GG2_PORT = 29942
NEWSTYLE_PORT = 29944
WEB_PORT = 29950
```

The Munin plugins rely on `config.py` as well. When symlinked into
`/etc/munin/plugins` make sure the plugins can locate the repository so the
import succeeds (they add the parent directory of the real script path to
`sys.path`).

## Running Tests

The project includes comprehensive integration tests that verify all protocols and functionality:

```bash
# Run all integration tests
python test_integration.py

# Or with virtual environment
source venv/bin/activate
python test_integration.py
```

The test suite includes:
- Web interface HTTP response testing
- New-style protocol server registration and querying
- Legacy GG2 protocol compatibility testing
- Server discovery and listing functionality

Tests automatically start/stop the lobby server and verify proper operation of all network protocols.

## Architecture

The system supports both legacy Gang Garrison 2 protocols and newer generic protocols. See CLAUDE.md for detailed architecture documentation.

## Legacy Note

This project was started for Gang Garrison 2, but is supposed to be more generic. At the moment, there are special exceptions and legacy protocol implementations in the code, but those should be put into separate modules later. The code could generally do with some splitting up.